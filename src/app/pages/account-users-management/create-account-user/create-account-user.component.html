<nb-card [nbSpinner]="isLoading" nbSpinnerStatus="primary" nbSpinnerSize="giant">
    <nb-card-header class="default-card-header">
        <h2 class="card-title">User Information</h2>
    </nb-card-header>
    <nb-card-body>
        <form [ngClass]="{'hide': isLoadingForm}" [nbSpinner]="isLoadingForm" nbSpinnerStatus="primary"
            nbSpinnerSize="large" nbSpinnerMessage="" [formGroup]="customerUserForm" (ngSubmit)="onSubmit()"
            class="form-container">

            <div class="row-container">

                <div class="input-container">
                    <div class="input-sub-container">
                        <label class="label-align">First Name</label>
                        <div class="input-item">
                            <input type="text" #firstName placeholder="First Name" formControlName="firstName"
                                id="firstName">
                            <div *ngIf="formSubmitted">
                                <div class="help-block error" *ngIf="
    customerUserForm.get('firstName').errors != null &&
    customerUserForm.get('firstName').errors[
    'requiredWithTrim'
    ] &&
    customerUserForm.get('firstName').touched
    ">
                                    First Name is required
                                </div>
                                <div class="help-block error" *ngIf="
    customerUserForm.get('firstName').errors != null &&
    customerUserForm.get('firstName').errors[
    'trimError'
    ] &&
    customerUserForm.get('firstName').touched
    ">
                                    This field can't start or end with a blank space
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="input-sub-container">
                        <label class="label-align">Last Name</label>
                        <div class="input-item">
                            <input type="text" placeholder="Last Name" formControlName="lastName" id="lastName">
                            <div *ngIf="formSubmitted">
                                <div class="help-block error" *ngIf="
    customerUserForm.get('lastName').errors != null &&
    customerUserForm.get('lastName').errors[
    'requiredWithTrim'
    ] &&
    customerUserForm.get('lastName').touched
    ">
                                    Last Name is required
                                </div>
                                <div class="help-block error" *ngIf="
    customerUserForm.get('lastName').errors != null &&
    customerUserForm.get('lastName').errors[
    'trimError'
    ] &&
    customerUserForm.get('lastName').touched
    ">
                                    This field can't start or end with a blank space
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="input-sub-container">
                        <label class="label-align">Email</label>
                        <div class="input-item">
                            <input type="text" (keydown.space)="$event.preventDefault()" placeholder="Email"
                                formControlName="email" id="email">
                            <div *ngIf="formSubmitted">
                                <div class="help-block error" *ngIf="
                    customerUserForm.get('email').errors != null &&
                    customerUserForm.get('email').errors['requiredWithTrim'] &&
                    customerUserForm.get('email').touched">
                                    Email is required
                                </div>
                                <div class="help-block error"
                                    *ngIf="
                    customerUserForm.get('email').dirty &&
                    customerUserForm.get('email').errors &&
                    (customerUserForm.get('email').errors['smartriseEmail'] && !customerUserForm.get('email').errors['trimError'])">
                                    Please enter a valid email
                                </div>
                                <div *ngIf="customerUserForm.get('email').touched && 
                  customerUserForm.get('email').errors && 
                  customerUserForm.get('email').errors['trimError']" class="mt-1 help-block error">
                                    This field can't start or end with a blank space
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="input-sub-container">
                        <label class="label-align">Choose account</label>
                        <div class="input-item">
                            <ngx-search-accounts-lookup
                                (accountSelected)="onSelectionChange($event)"></ngx-search-accounts-lookup>
                        </div>
                    </div>

                </div>

            </div>

            <div class="col-12 mb-2 px-0">
                <ngx-account-roles-selection #accounts [roles]="roles"
                    formControlName="accounts"></ngx-account-roles-selection>
            </div>

            <div [ngClass]="{'form-buttons': true, 'mt-3': customerUserForm.get('accounts')?.value?.length}">
                <button routerLink=".." type="button" class="secondary-button">
                    Cancel
                </button>
                <ngx-button [isLoading]="isSaving" type="submit" class="main-button">
                    Create
                </ngx-button>
            </div>
        </form>
    </nb-card-body>
</nb-card>